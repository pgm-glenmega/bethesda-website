{% extends "_layout.twig" %}

{% block title %}Prayer Room | Bethesda Ministry{% endblock %}

{% block head %}
  {{ parent() }}
  <link rel="stylesheet" href="/css/prayer-room.css?v={{ now.timestamp }}">
{% endblock %}

{% block content %}
  <div id="threejs-container"></div>

  <div id="prayer-form" class="form-container hidden">
    <div class="form-box">
      <h2 class="form-title">Submit a Prayer Request</h2>
      <p>Share your prayer request, and our community will pray for you.</p>

      {% if craft.app.session.getFlash('successMessage') %}
        <p class="success-message">{{ craft.app.session.getFlash('successMessage') }}</p>
      {% endif %}
      {% if craft.app.session.getFlash('errorMessage') %}
        <p class="error-message">{{ craft.app.session.getFlash('errorMessage') }}</p>
      {% endif %}

      <form method="POST" action="">
        {{ csrfInput() }}
        <input type="hidden" name="action" value="entries/save-entry">
        <input type="hidden" name="sectionId" value="4">
        <input type="hidden" name="title" value="{{ now|date('Y-m-d H:i') }} Prayer">

        <div class="form-group">
          <label for="requesterName">Name</label>
          <input type="text" name="fields[requesterName]" id="requesterName" class="form-input" required>
        </div>

        <div class="form-group">
          <label for="requesterEmail">E-mail</label>
          <input type="email" name="fields[requesterEmail]" id="requesterEmail" class="form-input" required>
        </div>

        <div class="form-group">
          <label for="prayerMessage">Prayer Request</label>
          <textarea name="fields[prayerMessage]" id="prayerMessage" class="form-textarea" required></textarea>
        </div>

        <div class="form-actions">
          <button type="button" id="close-form" class="btn-cancel">Cancel</button>
          <button type="submit" class="btn-submit">Submit</button>
        </div>
      </form>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.128/examples/js/loaders/GLTFLoader.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.128/examples/js/controls/OrbitControls.js"></script>
  <script src="js/prayer-room.js"></script>
{% endblock %}
