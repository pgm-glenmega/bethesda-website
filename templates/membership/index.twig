{% extends "_layout.twig" %}

{% block title %}Membership | Bethesda Ministry
{% endblock %}

{% block head %}
  {{ parent() }}
  <link rel="stylesheet" href="/css/membership.css?v={{ now.timestamp }}">
{% endblock %}

{% block content %}

  {% set entry = craft.entries()
  .section('membershipPage')
  .site(currentSite.handle)
  .one() %}

  {% if not entry %}
    <section class="membership-hero">
      <div class="membership-container">
        <p>No Membership entry found. Create a Single named “Membership” (handle: membership).</p>
      </div>
    </section>
  {% else %}
    {% set hero = entry.heroBackground.one() %}
    <section class="membership-hero" style="background: {% if hero %}url('{{ hero.getUrl() }}'){% else %}#111{% endif %} center/cover no-repeat;">
      <div class="hero-overlay"></div>

      <div class="membership-container">
        <div class="membership-content">
          <h1>{{ entry.heroHeading ?? 'Become a Member' }}</h1>

          {% if entry.heroSubheading %}
            <p class="subheading">{{ entry.heroSubheading }}</p>
          {% endif %}
          {% set rows = entry.membershipBenefits ?? [] %}

          {% if rows|length %}
            <ul class="benefits-list">
              {% for row in rows %}
                {% if row.showBenefit %}
                  <li>✔ {{ row.benefitText }}</li>
                {% endif %}
              {% endfor %}
            </ul>
          {% endif %}

          <p class="price">Only €10/year</p>

          <form method="post" class="membership-form">
            {{ csrfInput() }}
            <input type="hidden" name="action" value="stripe/stripe/create-checkout-session">
            <input type="text" name="fullName" placeholder="Full Name" required>
            <input type="email" name="email" placeholder="Email Address" required>
            <button type="submit" class="button primary">Join Now</button>
          </form>

          {% if entry.membershipGuarantee %}
            <p class="guarantee">{{ entry.membershipGuarantee }}</p>
          {% endif %}
        </div>
      </div>
    </section>
  {% endif %}

{% endblock %}
